[翻译](http://www.css88.com/book/css2/visudet.html#abs-non-replaced-width )

当使用'width', 'margin-left', 'margin-right', 'left', 'right'这些属性布局时，他们的使用值通过盒类型以及相互的关系获取。原则上，使用值和计算值相等，auto被替换成一些合适的值，百分比根据包含块计算，但是也有例外。

### 10.3.1 行内非替换元素

width属性不适用。如果margin-left和margin-right计算值为'auto'，其使用值为0

### 10.3.2 行内替换元素

1. margin-left和margin-right为'auto'：其使用值为0。
2. width为'auto'：
	- 该元素有固有宽度：width为固有宽度。
	- 没有固有宽度，但有固有高度和固有比例：根据height与比例计算width。


### 10.3.3 正常流中的块级非替换元素

使用值必须符合下面约束：

margin-left + border-left-width + padding-left + width + padding-right + border-right-width + margin-right = width of containing block

注意：margin padding 的默认值是0，border默认值和元素相关。

1. 所有值都不为auto：
	- 所有值之和大于包含块的宽度：对于ltr，margin-right为0；反之margin-left亦然。
	-  所有值之后小于包含块的宽度：对于ltr，margin-right占满剩下部分，反之margin-left亦然。 
2. 只有一个值为auto：auto需要满足上述等式。
3. 所有值都为auto：width为包含块宽度，其他值为0。
4. margin-left与margin-right为auto：
	- 所有值之和小于包含块宽度：两个值相等，元素居中。
	- 所有值之和大于包含块宽度：两个值都为0。

### 10.3.4 正常流中的块级替换元素

width的使用值由10.3.2中行内替换元素的规则决定。 margin规则由10.3.3中非替换块级元素的规则决定。

### 10.3.5 浮动非替换元素

shrink-to-fit 的计算公式：min(max(preferred minimum width, available width), preferred width)

CSS2.1 并未给出 preferred minimum width、available width 和 preferred width 确切算法，通常，将内容中非明确的换行外的其他部分强制不换行来计算 preferred width；反之，尝试将内容尽可能的换行，以得到 preferred minimum width；available width 即该元素的包含块的宽度减去 'margin-left'，'border-left-width'，'padding-left'，'padding-right'，'border-right-width'，'margin-right' 的值以及任何存在的纵向滚动条的宽度。

1. margin-left或margin-right为auto，使用值为0。
2. width计算值为auto，其使用值是shrink-to-fit值（简单理解为适应子元素的宽度）。

举个栗子：黑色边框可以看做是浮动div的宽度

	<div style='background-color:red;color: white'>
	    <div style='float:left;border:solid 1px darkblue;'>
			aaaaaaaaaaaaaa
		</div>
	    <div style="clear: both;"></div>
	</div>


![](img/1.jpg)

当内容太长时发生换行。

	<div style='background-color:red;color: white'>
	    <div style='float:left;border:solid 1px darkblue;'>
			aaaaaaaaaaaaaa aaaaaaaaaaaaaaaaaaaaa
		</div>
	    <div style="clear: both;"></div>
	</div>

![](img/2.jpg)

### 10.3.6 浮动替换元素 

1. margin-left或margin-right为auto，使用值为0。
2. width的使用值由行内替换元素的规则决定。

### 10.3.7 绝对定位非替换元素

确定这些元素计算值的约束为：

 'left' + 'margin-left' + 'border-left-width' + 'padding-left' + 'width' + 'padding-right' + 'border-right-width' + 'margin-right' + 'right' = 包含块的宽度

1. 如果'left'设置为'auto'而'direction'为'ltr'，替换'auto'为：包含块左边到假定它的'position'属性设置为'static'，而生成元素的第一个框的那个假想框的左边距边的距离。（但是为了不去实际计算那个框，用户端可以自由地猜想它可能在的位置。）如果假想框在包含块的左边，该值为负数。
1. 如果'right'设置为'auto'而'direction'为'rtl'，替换'auto'为：包含块右边到上述提到的那个假想框的右边距边的距离。如果假想框在包含块边的左边，该值为正数。
1. 如果'width'为'auto'，将剩余'left'或'right'的'auto'替换为'0'。
1. 如果'left'，'right'或'width'还是'auto'，将所有'margin-left'或'margin-right'的'auto'替换为'0'。
1. 如果在这一步'margin-left'和'margin-right'还是'auto'，基于额外的约束即两个边距必须相同，解出等式。
1. 如果在这一步只有一个'auto'存在，根据等式解出那个值。
1. 如果在这一步各值间过度约束，要么忽略'left'的值（如果'direction'为'rtl'），要么忽略'right'的值（如果'direction'为'ltr'），然后解出那个值。

### 10.3.8 绝对定位替换元素

对于这种情况，10.3.7上面的规则依然适用。10.3.7余下部分使用下面规则替换： 1. width的使用值由行内替换元素替换，如果margin-left或margin-right值是auto，使用值采用下面规则。 2. 如果left和right都是auto值，如果创建静态位置包含块元素的direction属性是ltr(rtl)，设置left(right)为静态位置。 3. 如果left或right是auto值，将margin-left或margin-right的auto值设为0。 4. 如果这时margin-left和margin-right值依然是auto，计算等式加上两个margin值必须相等的约束。如果计算得到的margin值为负值，则根据包含块的direction属性，如果为ltr(rtl)，设置margin-left(margin-right)为0，计算margin-right(margin-left)值。 5. 如果这时还有auto值，根据等式计算该值。 6. 如果这时存在过度约束，包含块direction属性为rtl(ltr)时，忽略left(right)值，计算等式。

### 10.3.9 正常流中'Inline-block'非替换元素

如果width是auto，使用值是shrink-to-fit值。计算值为auto的margin-left和margin-right，值为0。

### 10.3.10 正常流中'Inline-block'替换元素

和行内替换元素相同。